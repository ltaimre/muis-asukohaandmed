{"ast":null,"code":"var _jsxFileName = \"/Users/liisitaimre/Documents/hello-next/pages/index.js\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport dynamic from 'next/dynamic';\n\nconst rdfetch = require('@rdfjs/fetch');\n/*const Map = dynamic(() => import('../components/Map'), {\n    ssr: false,\n    loading: () => 'Loading...'\n});*/\n\n\nconst Test = props => __jsx(React.Fragment, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 12,\n    columnNumber: 5\n  }\n}, __jsx(\"p\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 13,\n    columnNumber: 9\n  }\n}, \"Museaale muuseumis: \", props.count), __jsx(\"p\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 14,\n    columnNumber: 9\n  }\n}, \"Museaale valikus: \", props.choice), __jsx(\"p\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 15,\n    columnNumber: 9\n  }\n}, \"Museaale s\\xFCndmusega: \", props.countEvent));\n\nTest.getInitialProps = async function getInitialProps(context) {\n  function isIterable(obj) {\n    if (obj == null) {\n      return false;\n    }\n\n    return typeof obj[Symbol.iterator] === 'function';\n  }\n\n  async function getPlace(link) {\n    const dataset = await rdfetch(`${link}`, {\n      headers: {\n        accept: 'application/rdf+xml'\n      }\n    }).then(res => res.dataset()).catch(err => console.error(err));\n\n    if (isIterable(dataset)) {\n      //\n      for (const quad of dataset) {\n        if (quad.predicate.value == \"http://www.w3.org/2000/01/rdf-schema#label\") {\n          console.log(`subjekt: ${quad.subject.value}, predikaat: ${quad.predicate.value} objekt: ${quad.object.value}`);\n        }\n      }\n    }\n  }\n\n  async function hasHigher(link) {\n    const dataset = await rdfetch(`${link}`, {\n      headers: {\n        accept: 'application/rdf+xml'\n      }\n    }).then(res => res.dataset()).catch(err => console.error(err));\n\n    if (isIterable(dataset)) {\n      //\n      for (const quad of dataset) {\n        console.log(`Küsitud: ${link}`);\n\n        if (quad.object.value == \"http://www.cidoc-crm.org/cidoc-crm/P127_has_broader_term\") {\n          console.log(`subjekt: ${quad.subject.value}, predikaat: ${quad.predicate.value} objekt: ${quad.object.value}`);\n        }\n      }\n    }\n  }\n\n  async function isTypeEvent(link) {\n    const dataset = await rdfetch(`${link}`, {\n      headers: {\n        accept: 'application/rdf+xml'\n      }\n    }).then(res => res.dataset()).catch(err => console.error(err));\n\n    if (isIterable(dataset)) {\n      let type = 0;\n      let place = [];\n\n      for (const quad of dataset) {\n        console.log(`subjekt: ${quad.subject.value}, predikaat: ${quad.predicate.value} objekt: ${quad.object.value}`);\n\n        if (quad.predicate.value == \"http://www.cidoc-crm.org/cidoc-crm/P2_has_type\") {\n          if (quad.object.value == \"http://opendata.muis.ee/thesaurus/61/11273\") {\n            //console.log(`subjekt: ${quad.subject.value}, predikaat: ${quad.predicate.value} objekt: ${quad.object.value}`);\n            type = 1;\n          } else {\n            console.log(`Küsin linki: ${quad.object.value}`);\n            let a = await hasHigher(quad.object.value);\n          }\n        }\n\n        if (quad.predicate.value == \"http://www.cidoc-crm.org/cidoc-crm/P7_took_place_at\") {\n          //console.log(`subjekt: ${quad.subject.value}, predikaat: ${quad.predicate.value} objekt: ${quad.object.value}`);\n          place.push(quad.object.value);\n        }\n      }\n\n      if (type && place.length) {\n        console.log(\"event\");\n\n        for (let x = 0; x < place.length; x++) {\n          console.log(x);\n          console.log(place[x]);\n          getPlace(place[x]);\n        }\n\n        return true;\n      }\n      /*   else{\n               if(quad.predicate.value == \"http://www.cidoc-crm.org/cidoc-crm/P2_has_type \" ) {\n                   console.log(`subjekt: ${quad.subject.value}, predikaat: ${quad.predicate.value} objekt: ${quad.object.value}`);\n                   return true;\n               }\n                  //hasHigher(quad.object.value);\n               }*/\n\n    }\n  }\n\n  async function hasEvent(link) {\n    const dataset = await rdfetch(`${link}`, {\n      headers: {\n        accept: 'application/rdf+xml'\n      }\n    }).then(res => res.dataset()).catch(err => console.error(err));\n\n    if (isIterable(dataset)) {\n      for (const quad of dataset) {\n        if (quad.predicate.value == \"http://www.cidoc-crm.org/cidoc-crm/P12_occurred_in_the_presence_of\") {\n          {\n            let isType = await isTypeEvent(quad.object.value);\n\n            if (isType) {\n              return true;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  let count = 0;\n  let countEvent = 0;\n  const choice = 20;\n  const array = []; //Jääri ajaloolised 1204\n  //Jääri fotod: 1252\n  //Jööri ajaloolised: 1238\n  //Meierei: 120 Üks - 0\n  //Pudukogu 1198\n  //Alver - ajalooline 392\n\n  const dataset = await rdfetch('https://www.muis.ee/rdf/collection/392', {\n    headers: {\n      accept: 'application/rdf+xml'\n    }\n  }).then(res => res.dataset()).catch(err => console.error(err));\n\n  if (isIterable(dataset)) {\n    for (const quad of dataset) {\n      if (quad.predicate.value == \"http://www.cidoc-crm.org/cidoc-crm/P46_is_composed_of\") {\n        array.push(quad.object.value);\n        count++;\n      }\n    }\n  }\n\n  for (let x = 0; x < choice; x++) {\n    {\n      let hasEv = await hasEvent(array[x]);\n\n      if (hasEv) {\n        countEvent++;\n      }\n    }\n  }\n\n  return {\n    count,\n    choice,\n    countEvent\n  };\n};\n\nexport default Test;","map":{"version":3,"sources":["/Users/liisitaimre/Documents/hello-next/pages/index.js"],"names":["React","dynamic","rdfetch","require","Test","props","count","choice","countEvent","getInitialProps","context","isIterable","obj","Symbol","iterator","getPlace","link","dataset","headers","accept","then","res","catch","err","console","error","quad","predicate","value","log","subject","object","hasHigher","isTypeEvent","type","place","a","push","length","x","hasEvent","isType","array","hasEv"],"mappings":"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","sourcesContent":["import React from 'react';\nimport dynamic from 'next/dynamic'\nconst rdfetch = require('@rdfjs/fetch');\n/*const Map = dynamic(() => import('../components/Map'), {\n    ssr: false,\n    loading: () => 'Loading...'\n});*/\n\n\nconst Test= props => (\n\n    <React.Fragment>\n        <p>Museaale muuseumis: {props.count}</p>\n        <p>Museaale valikus: {props.choice}</p>\n        <p>Museaale sündmusega: {props.countEvent}</p>\n\n    </React.Fragment>\n);\n\n\n\n   Test.getInitialProps = async function getInitialProps (context) {\n\n       function isIterable(obj) {\n           if (obj == null) {\n               return false;\n           }\n           return typeof obj[Symbol.iterator] === 'function';\n       }\n\n       async function getPlace(link) {\n           const dataset = await rdfetch(`${link}`, {\n               headers: {\n                   accept: 'application/rdf+xml'\n               }\n           })\n               .then(res => res.dataset())\n               .catch(err => console.error(err));\n           if(isIterable(dataset)) {\n               //\n               for (const quad of dataset) {\n                   if(quad.predicate.value == \"http://www.w3.org/2000/01/rdf-schema#label\" ) {\n                       console.log(`subjekt: ${quad.subject.value}, predikaat: ${quad.predicate.value} objekt: ${quad.object.value}`)\n                   }\n               }\n\n\n               }\n           }\n\n\n       async function hasHigher(link) {\n           const dataset = await rdfetch(`${link}`, {\n               headers: {\n                   accept: 'application/rdf+xml'\n               }\n           })\n               .then(res => res.dataset())\n               .catch(err => console.error(err));\n           if(isIterable(dataset)) {\n                //\n           for (const quad of dataset) {\n               console.log(`Küsitud: ${link}`);\n               if(quad.object.value == \"http://www.cidoc-crm.org/cidoc-crm/P127_has_broader_term\" ) {\n                   console.log(`subjekt: ${quad.subject.value}, predikaat: ${quad.predicate.value} objekt: ${quad.object.value}`)\n               }\n\n\n       }\n           }\n       }\n\n\n       async function isTypeEvent(link) {\n           const dataset = await rdfetch(`${link}`, {\n               headers: {\n                   accept: 'application/rdf+xml'\n               }\n           })\n               .then(res => res.dataset())\n               .catch(err => console.error(err));\n            if(isIterable(dataset)) {\n                let type = 0;\n                let place = [];\n                for (const quad of dataset) {\n                    console.log(`subjekt: ${quad.subject.value}, predikaat: ${quad.predicate.value} objekt: ${quad.object.value}`);\n                    if(quad.predicate.value == \"http://www.cidoc-crm.org/cidoc-crm/P2_has_type\" ) {\n                        if(quad.object.value == \"http://opendata.muis.ee/thesaurus/61/11273\" ) {\n                            //console.log(`subjekt: ${quad.subject.value}, predikaat: ${quad.predicate.value} objekt: ${quad.object.value}`);\n                            type = 1;\n                        }\n                        else {\n                            console.log(`Küsin linki: ${quad.object.value}`);\n                          let a = await hasHigher(quad.object.value)\n                        }\n\n\n                    }\n                    if(quad.predicate.value == \"http://www.cidoc-crm.org/cidoc-crm/P7_took_place_at\" ) {\n                        //console.log(`subjekt: ${quad.subject.value}, predikaat: ${quad.predicate.value} objekt: ${quad.object.value}`);\n\n                        place.push(quad.object.value);\n                    }\n                }\n\n                    if(type && place.length ) {\n                        console.log(\"event\");\n                        for(let x=0; x < place.length;  x++) {\n                            console.log(x);\n                            console.log(place[x]);\n                            getPlace(place[x]);\n                        }\n\n                        return true;\n                    }\n\n               /*   else{\n                        if(quad.predicate.value == \"http://www.cidoc-crm.org/cidoc-crm/P2_has_type \" ) {\n                            console.log(`subjekt: ${quad.subject.value}, predikaat: ${quad.predicate.value} objekt: ${quad.object.value}`);\n                            return true;\n                        }\n                           //hasHigher(quad.object.value);\n\n                       }*/\n\n\n\n\n\n            }\n\n\n       }\n\n       async function hasEvent(link) {\n          const dataset = await rdfetch(`${link}`, {\n              headers: {\n                  accept: 'application/rdf+xml'\n              }\n          })\n               .then(res => res.dataset())\n               .catch(err => console.error(err));\n           if(isIterable(dataset)) {\n           for (const quad of dataset) {\n               if (quad.predicate.value == \"http://www.cidoc-crm.org/cidoc-crm/P12_occurred_in_the_presence_of\" ) {\n                   { let isType = await isTypeEvent(quad.object.value);\n                       if(isType) {\n                           return true;\n                       }\n\n                   }\n\n\n               }\n           }\n           }\n       }\n\n\n\n\n       let count = 0;\n       let countEvent = 0;\n       const choice = 20;\n       const array = [];\n       //Jääri ajaloolised 1204\n       //Jääri fotod: 1252\n       //Jööri ajaloolised: 1238\n       //Meierei: 120 Üks - 0\n       //Pudukogu 1198\n       //Alver - ajalooline 392\n\n        const dataset = await rdfetch('https://www.muis.ee/rdf/collection/392', {\n           headers: {\n               accept: 'application/rdf+xml'\n           }\n       }).then(res => res.dataset()).catch(err => console.error(err));\n\n\n        if(isIterable(dataset)) {\n            for (const quad of dataset) {\n                   if(quad.predicate.value == \"http://www.cidoc-crm.org/cidoc-crm/P46_is_composed_of\")\n                   { array.push(quad.object.value);\n                       count ++\n                   }\n               }\n           }\n\n\n\n      for (let x = 0; x<choice; x++) {\n           { let hasEv = await hasEvent(array[x]);\n               if(hasEv) {\n                   countEvent++\n               }\n\n           }\n\n\n       }\n\n\n\n\n\n       return {count, choice, countEvent};\n    };\n\n\n\n\nexport default Test\n"]},"metadata":{},"sourceType":"module"}